#!/bin/bash
# find episodes missing in sal's library
SCRIPT_NAME="find-missing-in-sal"
PID=$$


# Source the VAR MOAS
source /usr/local/bin/VAR-SCRIPT


Dropbox="$DROPBOX/TV/lists"

cd "$Dropbox" || exit 1

echo "Deleting old list files"
rm -v abz*.txt 2>/dev/null
rm -v sal[23]*.txt 2>/dev/null
echo "Populating the episodes file"
find "$TV_SYM"  -type f  -size +20M > abz1.txt
while read f ; do basename "$f" | cut -d "]" -f1 >>| abz2.txt ;done < abz1.txt 
while read f ; do basename "$f" | cut -d "]" -f1 >>| sal2.txt ;done < sal1.txt
cut -d "]" -f1 * | sort -f |uniq -u > c1.txt
sed -i "s/\[/\\\[/g" c1.txt
while read -r a ; do grep -q "$a" abz1.txt && echo "$a - is in abz only" ; done < c1.txt


#sort -f abz2.txt > abz3.txt
#sort -f sal2.txt > sal3.txt

#diff -i sal3.txt abz3.txt | grep -E '>' > sal4-missing.txt
#diff -i sal3.txt abz3.txt | grep -E '<' > abz4-missing.txt
echo "Finished"
