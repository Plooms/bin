#!/bin/bash
# (Add - Move - Delete - Rename - Change - Find) and do lots of shit to the Media Collection


# Source the VAR MOAS
source /usr/local/bin/VAR-SCRIPT

TMP1="$(mktemp)"
TMP2="$(mktemp)"
TMP3="$(mktemp)"
TMP_LOG1="$(mktemp)"

start=$(dialog --stdout  --clear --help-button --help-label "Cancel" --yesno \
"Did you add the Show names to $BATCH_FILE_MOVIE_FIND ?" 10 50 )

case $? in
0)
if [ -f $BATCH_FILE_MOVIE_FIND ]
then

clear
echo "Searching for Video Files"

while read name
do
movie_array+=("$FILE")
done < "$BATCH_FILE_MOVIE_FIND"


for i in "${movie_array[@]}"
do

		

#################################
#MOVIE_NAME="$(basename "$( echo $i | rev |cut -b 5- | rev | sed "s/(//g;s/)//g;s/'/\\\\\\'/g" )")"
NAME="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select Name from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
SIZE="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select size_mb from movies where Name LIKE '%$MOVIE_NAME%'" -ss) MB"
RES1="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select ResWidth from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
RES2="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select ResHeight from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
DEF="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select definition from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
WATCHED="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select Watched from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
NOTES="$(mysql --user=root --password="$DB_PASSWORD" movies -e "select notes from movies where Name LIKE '%$MOVIE_NAME%'" -ss)"
#################################

if [ ! -z "$NAME" ]
then

GREEN
echo -e "Name =  ${WHITE}$NAME${COLOR_OFF}"
GREEN
echo -e "Size =  ${WHITE}$SIZE${COLOR_OFF}"
GREEN
echo -e "Resolution = ${WHITE}"$RES1 x $RES2"p ${COLOR_OFF}${PURPLE}  "$DEF" ${COLOR_OFF}"
GREEN
echo -e "Watched = ${WHITE}$WATCHED"
GREEN
echo -e "Notes =  ${CYAN}$NOTES${COLOR_OFF}"
YELLOW



echo -e "${RED}\n-----------################-------------\n${COLOR_OFF}"

fi



####### For the log file#########
echo -e "
Path= $i
Name =  $NAME
Size =  $SIZE
Resolution = $RES1 x $RES2p  $DEF
Watched = $WATCHED
-----------################-------------
" >> "$TMP_LOG1"

####### For the log file#########

done



#---#

echo -e "${YELLOW}\n-----------################-------------\n${COLOR_OFF}" 

while read name
do
find "$MOVIE_SYM"/ -type d -iname "*$name*" | sort -bf >> "$TMP3"
done < "$BATCH_FILE_MOVIE_FIND"

WHITE 
cat "$TMP3" |sort -bf

echo -e "${YELLOW}\n-----------################-------------\n${COLOR_OFF}"


echo "Log File: g $TMP_LOG1"

else
sudo nano $BATCH_FILE_MOVIE_FIND ; c.ln2tb-movie-find-batch

fi

exit 0

;;
1)
sudo nano $BATCH_FILE_MOVIE_FIND ; c.ln2tb-movie-find-batch
;;
2)
_CANCEL_MSG ;; 
esac
